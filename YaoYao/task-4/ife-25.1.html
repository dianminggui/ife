<!DOCTYPE html>
<html>
<head>
	<title>IFE Integrated Task 04</title>
	<meta charset="utf-8" />
	<style type="text/css">
		#chess{
			margin-left: 40px;
			outline:1px solid #000;
		}
		#chess td{
			position: relative;
		}
		#chess span{
			position: absolute;
			left:-40px;
			top:0px;
			text-align: center;
			line-height: 40px;
			width:40px;
			font-size: 20px;
		}
		table{
			border-collapse: collapse;
			text-align: center;
			font-size: 0px;
		}
		td{
			border:1px solid #b2b2b2;
			height: 40px;
			width:40px;
			padding:0px;
		}
		input,button{
			margin-top: 20px;
			border-radius: 5px;
			border:1px solid #b2b2b2;
			font-size: 20px;
		}
		input{
			margin-left: 40px;
			margin-right: 10px;
			text-indent: 5px;
		}
		.tip td{
			border-color:#fff;
			font-size: 20px;
		}
	</style>
</head>
<body>
	<table class="tip">
		<tr>
			<td></td>
			<td>1</td>
			<td>2</td>
			<td>3</td>
			<td>4</td>
			<td>5</td>
			<td>6</td>
			<td>7</td>
			<td>8</td>
			<td>9</td>
			<td>10</td>
		</tr>
	</table>
	<table id="chess">
		<tr>
			<td class="noneBorder"><span>1</span></td>
			<td class="topBorder leftBorder"></td>
			<td class="topBorder"></td>
			<td class="topBorder"></td>
			<td class="topBorder"></td>
			<td class="topBorder"></td>
			<td class="topBorder"></td>
			<td class="topBorder"></td>
			<td class="topBorder"></td>
			<td class="topBorder"></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>2</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>3</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>4</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>5</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>6</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td id="box" style="background-color: red;vertical-align: top;"><div style='display:inline-block;width:40px;height:10px;background-color: blue;'></div></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>7</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>8</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder"><span>9</span></td>
			<td class="leftBorder"></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td class="noneBorder bottomBorder"><span>10</span></td>
			<td class="bottomBorder leftBorder"></td>
			<td class="bottomBorder"></td>
			<td class="bottomBorder"></td>
			<td class="bottomBorder"></td>
			<td class="bottomBorder"></td>
			<td class="bottomBorder"></td>
			<td class="bottomBorder"></td>
			<td class="bottomBorder"></td>
			<td class="bottomBorder"></td>
		</tr>
	</table>
	<input type="text" name="operation" /><button type="button">执行</button>

	<script type="text/javascript">
		(function(){
			var btn = document.getElementsByTagName('button')[0];

			function changeNode( newone, oldone, div ) {
				newone.id = "box";
				newone.style.backgroundColor = "red";
				newone.style.textAlign = oldone.style.textAlign;
				newone.style.verticalAlign = oldone.style.verticalAlign;
				newone.appendChild(div);

				oldone.style.backgroundColor = "#fff";
				oldone.id = undefined;
			}

			btn.onclick = function() {
				var text = document.getElementsByTagName('input')[0].value;
				var box = document.getElementById('box');
				var div = box.getElementsByTagName('div')[0];

				if (text.toLowerCase() == 'go'){
					var table = document.getElementById('chess');
					var tr = table.getElementsByTagName('tr');
					var tds = box.parentNode.getElementsByTagName('td');
					var nowTr = tds[0].firstChild.firstChild.nodeValue - 1;
					var nowTd;
					for (var p = 0; p < 10; p++){
						if (tds[p].id == 'box'){
							nowTd=p;
							break;
						}
					}

					if (div.style.width =='40px'){
						if (box.style.verticalAlign == 'top') {
							if( nowTr - 1 >= 0){
								changeNode(tr[nowTr - 1].getElementsByTagName('td')[nowTd],box,div);
							}
						}
						else{
							if( + nowTr + 1 <= 9){
								changeNode(tr[+nowTr + 1].getElementsByTagName('td')[nowTd],box,div);
							}
						}
					}
					else {
						if (box.style.textAlign == 'left') {
							if( nowTd - 1 >= 0){
								changeNode(tds[nowTd - 1],box,div);
								
							}
						}
						else {
							if( + nowTd + 1 <= 9){
								changeNode(tds[+ nowTd + 1],box,div);
							}
						}
					}
				}
				
				else if (text.toLowerCase() == 'tun lef') {
					if( div.style.width =='40px'){
						div.style.width = '10px';
						div.style.height = '40px';
						if(box.style.verticalAlign == 'top') {
							box.style.textAlign = 'left';

						}
						else {
							box.style.textAlign = 'right';
						}
					}
					else {
						div.style.width = '40px';
						div.style.height = '10px';
						if (box.style.textAlign == 'left'){
							box.style.verticalAlign = 'bottom';
						}
						else {
							box.style.verticalAlign = 'top';
						}
					}

					
				}
				else if (text.toLowerCase() == 'tun rig') {
					if( div.style.width =='40px'){
						div.style.width = '10px';
						div.style.height = '40px';
						if(box.style.verticalAlign == 'top') {
							box.style.textAlign = 'right';

						}
						else {
							box.style.textAlign = 'left';
						}
					}
					else {
						div.style.width = '40px';
						div.style.height = '10px';
						if (box.style.textAlign == 'left'){
							box.style.verticalAlign = 'top';
						}
						else {
							box.style.verticalAlign = 'bottom';
						}
					}

				}
				else if (text.toLowerCase() == 'tun bac') {
					if( div.style.width =='40px'){
						if(box.style.verticalAlign == 'top') {
							box.style.verticalAlign = 'bottom';

						}
						else {
							box.style.verticalAlign = 'top';
						}
					}
					else {
						if (box.style.textAlign == 'left'){
							box.style.textAlign = 'right';
						}
						else {
							box.style.textAlign = 'left';
						}
					}
				}
				else{
					alert("请输入'GO','TUN LEF','TUN RIG'或者'TUN BAC'\n\nGO：向蓝色边所面向的方向前进一格\nTUN LEF：向左转（逆时针旋转90度）\nTUN RIG：向右转（顺时针旋转90度）\nTUN BAC：向右转（旋转180度）");
				}
			};

		})();
	</script>
</body>
</html>